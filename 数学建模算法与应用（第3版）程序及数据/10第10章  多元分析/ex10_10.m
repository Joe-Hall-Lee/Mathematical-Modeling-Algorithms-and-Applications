clc, clear
r = [1, 1 / 5, -1 / 5; 1 / 5, 1, -2 / 5; -1 / 5, -2 / 5, 1];
% 下面利用相关系数矩阵求主成分解，vec 的列为 r 的特征向量，即主成分的系数
[vec, val, con] = pcacov(r) % val 为 r 的特征值，con 为各个主成分的贡献率
num = input('请选择公共因子的个数：'); % 交互式选取主因子的个数
a = vec .* sqrt(val') % 利用矩阵广播，计算因子载荷矩阵
aa = a(:, 1:num) % 提出两个主因子的载荷矩阵
s1 = sum(aa.^2) % 计算对 X 的贡献，实际上等于对应的特征值
s2 = sum(aa.^2, 2) % 计算共同度